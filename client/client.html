<head>
  <title>cyborgmaster</title>
</head>

<body>
</body>

<!--*********** home ************* -->

<template name="home">
  <h3>targets</h3>
  <ul>
    <li>
      <a href="{{pathFor 'home' id='_id'}}">home</a>
    </li>
    <li>
      <a href="{{pathFor 'master' id='_id'}}"><b>master</b></a>
    </li>    
    {{#each players}}
      <li>
        <a href="{{pathFor 'player' id=_id}}">{{info}}</a>
      </li>
    {{/each}}
  </ul>

  {{> medialist}}
  {{> userslist}}
  {{> playerslist}}
</template>

<template name="medialist">
  <h3>media</h3>
  <ul>
  {{#each media}}
    <li>
      {{name}}
    </li>
  {{/each}}
  </ul>
</template>

<template name="playerslist">
  <h3>players</h3>
  <ul>
  {{#each players}}
    <li>
      {{_id}}/{{type}}/{{info}}
    </li>
  {{/each}}
  </ul>
</template>

<template name="userslist">
  <h3>connections</h3>
  <ul>
  {{#each users}}
    <li>
      {{connectionId}} {{ipAddr}}
    </li>
  {{/each}}
  </ul>
</template>  

<!--*********** master ************* -->

<template name="master">
  <table>
    <tr>
      <th></th>
      {{#each players}}
        <th class="monitored {{#if connected}}connected{{/if}}">
          {{info}}
          <br>
          {{#if isPlayerType 'rpi'}}
            {{#if muted}}
              <button class="unmute"><i class="fa fa-volume-off"></i></button>
            {{else}}
              <button class="mute"><i class="fa fa-volume-up"></i></button>
            {{/if}}
          {{else}}
            <input class="volume" type="range" min="0" max="1" step="0.1" value={{volume}}>
          {{/if}}
        </th>
      {{/each}}
    </tr>
    {{#each media}}
      <tr>
      <th>{{name}}</th>
        {{#each players}}
          <td data-media="{{../name}}" data-player="{{_id}}" class="{{#if isSelected}}selected{{/if}} {{#if isPreselected}}preselected{{/if}}">
            {{#if setup}}
              {{>setupCell}}
            {{else}}
              {{> tableCell}}
            {{/if}}
          </td>
        {{/each}}
      </tr>
    {{/each}}
  </table>
  <div class="general_controls">
    <p class="group">
      <span>Group selection: </span>
      <button class="prepare_select">select/preload</button>

      <button class="play"><i class="fa fa-play"></i></button>
      <button class="pause"><i class="fa fa-pause"></i></button>      
      <button class="stop"><i class="fa fa-stop"></i></button>

      <button class="prepare_clear">clear</button>

    </p>
    <p>
      <label><input id="show_labels" type="checkbox" value="yes" {{labelschecked}}> Show screen labels</label><br>
      <!--label><input id="show_setup" type="checkbox" value="yes" {{setupchecked}}> Raspberries media setup</label-->
    </p>
  </div>
</template>

<template name="setupCell">
  {{#if raspberry}}
    <input class="available" type="checkbox" {{checked}}>
  {{/if}}
</template>

<template name="tableCell">
  <div class="state">
    <input class="preselect" type="checkbox" name="{{_id}}" value="{{../name}}" {{preselected}}>
    <input class="select" type="radio" name="{{_id}}" value="{{../name}}" {{selected}}>
    {{#if isSelected}}
      {{#if isMediaState 'stop'}}
        <button class="play"><i class="fa fa-play"></i></button>
      {{else}}
        {{#if isMediaState 'pause'}}
          <button class="play"><i class="fa fa-play"></i></button>
        {{else}}
          <button class="pause"><i class="fa fa-pause"></i></button>      
        {{/if}}
        <button class="stop"><i class="fa fa-stop"></i></button>
      {{/if}}
    {{else}}
      <button class="play"><i class="fa fa-play"></i></button>
    {{/if}}
  </div>
</template>

<!--*********** player ************* -->

<template name="player">
  {{#with player}}
    <div id="player" data-state="{{state}}">
      {{#if show_info}}
      <h1 class="info">{{info}}</h1>
      {{/if}}
      <video width="1280" height="720" preload="auto">
        video not supported
      </video>
    </div>
  {{/with}}
</template>